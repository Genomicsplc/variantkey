context("variantkey")
library(variantkey)

# test-variantkey.R
# @category   Libraries
# @author     Nicola Asuni <nicola.asuni@genomicsplc.com>
# @copyright  2017-2018 GENOMICS plc
# @license    MIT (see LICENSE)
# @link       https://github.com/genomicsplc/variantkey

# test data: chromosome name
v.chrom <- c("1", "01", "001", "0001", "chr1", "CHR1", "chr01", "CHR01", "chr001", "CHR001", "1", "2", "02", "002", "0002", "chr2", "CHR2", "chr02", "CHR02", "chr002", "CHR002", "2", "2", "3", "03", "003", "0003", "chr3", "CHR3", "chr03", "CHR03", "chr003", "CHR003", "3", "3", "3", "4", "04", "004", "0004", "chr4", "CHR4", "chr04", "CHR04", "chr004", "CHR004", "4", "4", "4", "4", "5", "05", "005", "0005", "chr5", "CHR5", "chr05", "CHR05", "chr005", "CHR005", "5", "5", "5", "5", "5", "6", "06", "006", "0006", "chr6", "CHR6", "chr06", "CHR06", "chr006", "CHR006", "6", "6", "6", "6", "6", "6", "7", "07", "007", "0007", "chr7", "CHR7", "chr07", "CHR07", "chr007", "CHR007", "7", "7", "7", "7", "7", "7", "7", "8", "08", "008", "0008", "chr8", "CHR8", "chr08", "CHR08", "chr008", "CHR008", "8", "8", "8", "8", "8", "8", "8", "8", "9", "09", "009", "0009", "chr9", "CHR9", "chr09", "CHR09", "chr009", "CHR009", "9", "9", "9", "9", "9", "9", "9", "9", "9", "10", "010", "0010", "00010", "chr10", "CHR10", "chr010", "CHR010", "chr0010", "CHR0010", "10", "10", "10", "10", "10", "10", "10", "10", "10", "10", "11", "011", "0011", "00011", "chr11", "CHR11", "chr011", "CHR011", "chr0011", "CHR0011", "11", "11", "11", "11", "11", "11", "11", "11", "11", "11", "11", "12", "012", "0012", "00012", "chr12", "CHR12", "chr012", "CHR012", "chr0012", "CHR0012", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "13", "013", "0013", "00013", "chr13", "CHR13", "chr013", "CHR013", "chr0013", "CHR0013", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "14", "014", "0014", "00014", "chr14", "CHR14", "chr014", "CHR014", "chr0014", "CHR0014", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "15", "015", "0015", "00015", "chr15", "CHR15", "chr015", "CHR015", "chr0015", "CHR0015", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "16", "016", "0016", "00016", "chr16", "CHR16", "chr016", "CHR016", "chr0016", "CHR0016", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "17", "017", "0017", "00017", "chr17", "CHR17", "chr017", "CHR017", "chr0017", "CHR0017", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "18", "018", "0018", "00018", "chr18", "CHR18", "chr018", "CHR018", "chr0018", "CHR0018", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "19", "019", "0019", "00019", "chr19", "CHR19", "chr019", "CHR019", "chr0019", "CHR0019", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "20", "020", "0020", "00020", "chr20", "CHR20", "chr020", "CHR020", "chr0020", "CHR0020", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "21", "021", "0021", "00021", "chr21", "CHR21", "chr021", "CHR021", "chr0021", "CHR0021", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "22", "022", "0022", "00022", "chr22", "CHR22", "chr022", "CHR022", "chr0022", "CHR0022", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "X", "x", "chrX", "chrx", "CHRX", "CHRx", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "Y", "y", "chrY", "chry", "CHRY", "CHRy", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "M", "m", "MT", "mt", "chrM", "chrm", "chrMT", "chrmt", "CHRMt", "CHRmT", "chrMt", "chrmT", "Mt", "mT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "mt")

# test data: normalized chromosome name
v.nchrom <- c("1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "2", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "3", "4", "4", "4", "4", "4", "4", "4", "4", "4", "4", "4", "4", "4", "4", "5", "5", "5", "5", "5", "5", "5", "5", "5", "5", "5", "5", "5", "5", "5", "6", "6", "6", "6", "6", "6", "6", "6", "6", "6", "6", "6", "6", "6", "6", "6", "7", "7", "7", "7", "7", "7", "7", "7", "7", "7", "7", "7", "7", "7", "7", "7", "7", "8", "8", "8", "8", "8", "8", "8", "8", "8", "8", "8", "8", "8", "8", "8", "8", "8", "8", "9", "9", "9", "9", "9", "9", "9", "9", "9", "9", "9", "9", "9", "9", "9", "9", "9", "9", "9", "10", "10", "10", "10", "10", "10", "10", "10", "10", "10", "10", "10", "10", "10", "10", "10", "10", "10", "10", "10", "11", "11", "11", "11", "11", "11", "11", "11", "11", "11", "11", "11", "11", "11", "11", "11", "11", "11", "11", "11", "11", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "12", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "13", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "14", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "15", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "16", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "17", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "18", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "19", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "20", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "21", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "22", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "X", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "Y", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT", "MT")

# rest data: expected encoded CHROM
v.kchrom <- c(0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x03, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x05, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x07, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x09, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0a, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0b, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0c, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0d, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0e, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x0f, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x10, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x11, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x13, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x14, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x15, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x16, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x17, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x18, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19, 0x19)

# test data: position
v.pos <- c(268435455, 324675, 0, 268435455, 324683, 324692, 324695, 324728, 1, 324739, 324750, 28001, 28003, 28005, 28013, 28017, 28045, 28056, 28057, 28058, 28067, 28106, 28136, 74852, 74859, 74915, 74915, 74916, 74916, 74917, 74923, 74930, 74931, 74958, 74970, 74970, 60482, 60502, 60502, 60502, 60502, 60502, 60502, 60513, 60569, 60622, 60683, 60819, 60835, 60867, 28314, 28329, 28338, 28341, 28342, 28373, 28375, 28383, 28405, 28421, 28510, 28518, 28528, 28552, 28572, 193224, 193225, 193226, 193238, 193297, 193309, 193311, 193321, 193321, 193321, 193322, 193329, 193329, 193331, 193335, 193335, 2287944, 2287972, 2287999, 2288016, 2288048, 2288064, 2288095, 2288096, 2288143, 2288144, 2288159, 2288180, 2288181, 2288181, 2288181, 2288181, 2288181, 167607, 167613, 167615, 167632, 167764, 167766, 167775, 167780, 167800, 167809, 167814, 167821, 167827, 167839, 167839, 167841, 167871, 167888, 82863, 82869, 82893, 82940, 82940, 82941, 82943, 82998, 83006, 83009, 83020, 83021, 83037, 83041, 83044, 83045, 83046, 83046, 83052, 102109, 102137, 102149, 102177, 102180, 102251, 102333, 102352, 102370, 102421, 102442, 102448, 102483, 102484, 102501, 102512, 102529, 102533, 102534, 102540, 208345, 208384, 208399, 208403, 208429, 208432, 208485, 208489, 208576, 208603, 208604, 208608, 208618, 208640, 208644, 208687, 208687, 208707, 208715, 208740, 208747, 94802, 94997, 95003, 95019, 95021, 95028, 95030, 95039, 95041, 95062, 95070, 95075, 95081, 95087, 95096, 95103, 95119, 95129, 95137, 95139, 95153, 95178, 19053895, 19053918, 19053938, 19053988, 19054028, 19054033, 19054056, 19054060, 19054079, 19054093, 19054093, 19054093, 19054095, 19054099, 19054107, 19054108, 19054116, 19054125, 19054169, 19054192, 19054213, 19054217, 19054220, 19046306, 19046323, 19046324, 19046331, 19046376, 19046392, 19046393, 19046398, 19046420, 19046423, 19046453, 19046454, 19046469, 19046472, 19046485, 19046486, 19046492, 19046500, 19046511, 19046512, 19046513, 19046515, 19046525, 19046531, 20030513, 20030522, 20030523, 20030524, 20030525, 20030532, 20030535, 20030538, 20030543, 20030545, 20030555, 20030559, 20030566, 20030573, 20030574, 20030576, 20030584, 20030594, 20030598, 20030603, 20030603, 20030606, 20030637, 20030656, 20030662, 20030676, 132201, 132218, 132222, 132223, 132228, 132230, 132234, 132245, 132253, 132255, 132256, 132328, 132378, 132402, 132430, 132463, 132464, 132504, 132509, 132527, 132535, 132559, 132595, 132627, 132648, 132654, 66884, 66886, 66887, 66901, 66928, 66936, 66939, 66970, 66971, 66988, 66995, 66997, 67010, 67028, 67036, 67041, 67065, 67071, 67119, 67138, 67139, 67140, 67158, 67165, 67165, 67181, 67192, 85036, 85047, 85068, 85092, 85094, 85112, 85127, 85135, 85144, 85145, 85148, 85156, 85158, 85176, 85187, 85199, 85206, 85208, 85229, 85234, 85236, 85238, 85238, 85248, 85272, 85277, 85278, 85323, 281247, 281254, 281296, 281298, 281316, 281320, 281324, 281336, 281342, 281354, 281356, 281359, 281362, 281367, 281371, 281375, 281382, 281383, 281394, 281402, 281403, 281404, 281412, 281414, 281421, 281423, 281429, 281432, 281434, 152849, 152863, 152869, 152883, 152898, 152907, 152914, 152946, 152971, 152983, 152991, 152996, 153004, 153005, 153006, 153022, 153056, 153098, 153138, 153139, 153150, 153153, 153168, 153266, 153284, 153285, 153291, 153295, 153297, 153297, 10800149, 10800159, 10800162, 10800175, 10800177, 10800179, 10800200, 10800209, 10800214, 10800225, 10800242, 10800243, 10800252, 10800260, 10800262, 10800267, 10800275, 10800280, 10800285, 10800288, 10800297, 10800297, 10800298, 10800307, 10800312, 10800317, 10800320, 10800322, 10800334, 10800357, 10800364, 16471041, 16471079, 16471082, 16471132, 16471141, 16471150, 16471169, 16471215, 16471224, 16471237, 16471460, 16471471, 16471542, 16471543, 16471660, 16471697, 16471712, 16471823, 16471999, 16472177, 16472753, 16472816, 16473065, 16473366, 16473372, 16473388, 16473413, 16473442, 16473456, 16473567, 16473651, 16473654, 2789116, 2789137, 2789141, 2789146, 2789155, 2789163, 2789182, 2789191, 2789209, 2789229, 2789344, 2789360, 2789377, 2789384, 2789423, 2789427, 2789427, 2789531, 2789563, 2789622, 2789674, 2789684, 2789687, 2789724, 2789729, 2789729, 2789729, 2789729, 2789729, 2789801, 2789847, 2789966, 2789974, 445728, 445771, 445773, 445779, 445786, 445794, 445797, 445808, 445818, 445821, 445832, 445850, 445876, 445890, 445897, 445919, 445932, 445937, 445948, 445955, 445957, 445959, 445974, 445977, 445978, 445978, 445997, 446013, 446014, 446018, 446018, 446022, 446054, 446055, 16305, 16308, 16310, 16318, 16319, 16324, 16326, 16331, 16336, 16343, 16344, 16354, 16355, 16358, 16359, 16361, 16389, 16390, 16398, 16444, 16498, 16511, 16518, 16527, 16528)

# test data: reference allele
v.ref <- c("C", "G", "ACCTCACCAGGCCCAGCTCATGCTTCTTTGCAG", "ACCAGGCCCAGCTCATGCTTCTTTGCAGCCTCT", "C", "N", "ATGCTTCTTTGCAGCCTCTCCAGGCCCAGCTCC", "T", "TGGCCCCTCCAGGCCCAGCCTCTGCCTCCCGTC", "ACGTUWSMKRYBDHVN", "G", "G", "G", "A", "T", "CAATTGTGAAGCAGTG", "A", "A", "T", "ACGTAC", "G", "ACGTACGTAC", "T", "G", "G", "AGT", "AG", "GT", "GT", "T", "G", "C", "A", "C", "CTATT", "CTATT", "T", "A", "AT", "ATT", "A", "A", "AT", "T", "G", "G", "G", "T", "C", "C", "AT", "G", "C", "C", "G", "T", "C", "C", "A", "T", "C", "T", "G", "T", "G", "GGG", "G", "G", "A", "CT", "A", "G", "CGTGT", "CGTGT", "CGT", "G", "TCA", "TCAT", "A", "GTA", "GTA", "C", "T", "G", "G", "G", "A", "C", "G", "C", "G", "T", "GCTTTT", "CT", "CTTTTTT", "CTT", "CTTTTTT", "C", "G", "C", "C", "C", "CTT", "T", "T", "T", "T", "G", "C", "C", "CTTCCTGTCTTTATTTTGT", "A", "AT", "T", "T", "T", "A", "G", "CT", "TTG", "TTGC", "T", "C", "A", "A", "C", "GTT", "T", "A", "A", "G", "G", "C", "C", "G", "C", "C", "C", "T", "C", "T", "C", "G", "A", "C", "G", "C", "C", "C", "G", "A", "GCTACGCACTTGTAGATAACCAGGTCTCATGAAAA", "C", "G", "G", "T", "G", "G", "G", "C", "AC", "TC", "A", "C", "G", "G", "G", "G", "G", "C", "CTTAAAGCGCCACCAGACGCTGCGCCCCG", "CTTAAAGCGCCACCAGACGCTGCGCCCCG", "T", "G", "C", "C", "G", "G", "G", "T", "C", "G", "C", "C", "C", "G", "C", "A", "G", "C", "C", "G", "A", "G", "C", "G", "C", "G", "T", "T", "A", "A", "T", "A", "AAT", "T", "TATA", "A", "ATG", "ATG", "G", "TA", "TAAATATTG", "A", "GTATAA", "AT", "T", "A", "G", "G", "G", "C", "T", "G", "C", "A", "T", "G", "A", "T", "G", "C", "C", "C", "C", "A", "T", "C", "TTCTACAAAAAG", "G", "A", "G", "C", "A", "A", "G", "G", "T", "C", "C", "A", "G", "C", "A", "A", "C", "C", "A", "G", "A", "C", "A", "G", "A", "T", "T", "TA", "C", "C", "G", "A", "A", "C", "A", "T", "G", "G", "C", "G", "G", "C", "G", "C", "A", "G", "T", "C", "G", "G", "G", "C", "G", "G", "C", "G", "G", "C", "G", "A", "C", "G", "A", "T", "G", "C", "T", "A", "GA", "C", "T", "GTTA", "G", "C", "G", "G", "T", "CATTAAAATTGGCCTCACTGAAATCAGGACCCCCAAGGCATTTCGTTCCCATCTCGGGCAGTTATTACAGAGCCCTTCTTCTGTGCCAAAATTGGCCTCGCTGAAATCAGGACCCCCAAGGCATTTCATTCCCATCTGGGGCAGTTATTACAGAGCCCTTCTTCTGCGC", "A", "T", "A", "G", "GA", "C", "C", "C", "C", "G", "T", "C", "C", "G", "G", "C", "A", "C", "C", "C", "ACT", "C", "CAGA", "AC", "A", "G", "C", "G", "G", "G", "T", "C", "C", "G", "C", "G", "G", "G", "G", "G", "T", "G", "G", "C", "C", "C", "C", "C", "T", "T", "C", "C", "G", "G", "C", "G", "G", "T", "G", "T", "G", "C", "G", "C", "C", "T", "G", "G", "G", "G", "C", "G", "T", "C", "C", "G", "G", "C", "G", "G", "T", "C", "C", "T", "A", "A", "A", "T", "C", "G", "ATTTC", "CTTTGT", "T", "T", "G", "G", "A", "C", "A", "G", "G", "G", "C", "G", "G", "G", "G", "C", "A", "G", "G", "C", "G", "T", "A", "A", "T", "G", "G", "A", "GAGTGGAATGGAATAGAGTGTAGTGAAATGC", "GT", "A", "A", "G", "C", "C", "C", "T", "G", "T", "G", "A", "T", "A", "A", "AT", "C", "A", "GA", "T", "C", "A", "G", "C", "G", "T", "G", "G", "G", "G", "A", "C", "A", "C", "G", "A", "T", "T", "G", "A", "G", "G", "C", "G", "TGGTGTGTA", "C", "C", "C", "G", "T", "C", "TA", "TA", "C", "C", "C", "G", "G", "G", "C", "CAAATAAATAAATAAAT", "CAAATAAATAAATAAATAAAT", "CAAATAAATAAATAAAT", "CAAATAAATAAATAAATAAAT", "CAAATAAATAAATAAAT", "C", "T", "A", "G", "G", "A", "AAG", "G", "GAGAA", "AAGAAAGAAAG", "A", "AAGAAAGAAAC", "CAAAA", "A", "G", "AAAAG", "GGAA", "GAAAGA", "AAGAG", "A", "G", "GAGAA", "A", "GAA", "A", "G", "A", "GAA", "A", "AAAGAAAGAAAGAAAGAAAG", "G", "G", "A", "A", "AAAGG", "G", "C", "G", "C", "A", "T", "G", "C", "T", "C", "C", "C", "C", "A", "C", "T", "T", "C", "T", "G", "G", "A", "T", "A", "T", "T", "C", "t")

# test data: alternate allele
v.alt <- c("T", "C", "A", "A", "G", "A", "A", "C", "T", "A*C*G*T*U*W*S*M*K*R*Y*B*D*H*V*N", "T", "A", "C", "G", "C", "C", "G", "G", "C", "CGTAC", "ACGTACGTAC", "G", "TG", "A", "A", "AA", "A", "G", "G", "A", "A", "T", "T", "T", "C", "C", "C", "AT", "A", "A", "AT", "AT", "A", "A", "A", "A", "A", "C", "T", "T", "A", "C", "T", "T", "A", "C", "A", "T", "G", "C", "T", "C", "A", "A", "T", "GA", "A", "A", "G", "C", "G", "A", "C", "C", "C", "A", "TGTCG", "TGTC", "G", "G", "G", "T", "C", "A", "A", "A", "ATTCT", "T", "T", "A", "A", "A", "G", "C", "C", "C", "C", "CT", "C", "T", "T", "A", "C", "A", "A", "G", "C", "A", "A", "T", "C", "C", "A", "G", "C", "C", "G", "A", "C", "TCA", "TCGG", "C", "G", "C", "T", "A", "G", "C", "G", "T", "C", "GTCTTC", "CAT", "CCAT", "C", "T", "A", "A", "C", "T", "G", "T", "A", "T", "T", "A", "A", "T", "T", "A", "G", "G", "T", "A", "T", "TC", "C", "C", "C", "G", "A", "T", "G", "T", "A", "A", "A", "C", "C", "T", "C", "C", "C", "C", "T", "T", "C", "C", "T", "C", "T", "C", "T", "T", "T", "C", "A", "G", "C", "G", "T", "C", "G", "T", "G", "A", "G", "A", "C", "C", "T", "G", "G", "G", "A", "A", "T", "ATG", "A", "A", "A", "T", "TAAATATTT", "G", "G", "A", "TTA", "G", "A", "A", "A", "T", "G", "C", "A", "C", "C", "C", "C", "C", "A", "T", "T", "A", "T", "G", "G", "A", "T", "A", "G", "C", "G", "T", "T", "T", "C", "C", "G", "T", "G", "A", "T", "G", "G", "A", "T", "AT", "T", "C", "T", "G", "A", "C", "TA", "TAATA", "T", "A", "T", "C", "C", "G", "T", "C", "C", "A", "A", "G", "A", "A", "T", "A", "T", "G", "T", "C", "T", "A", "T", "A", "T", "A", "T", "T", "A", "A", "T", "A", "G", "T", "A", "C", "A", "C", "T", "G", "G", "G", "T", "C", "G", "A", "G", "A", "A", "C", "CAT", "G", "C", "G", "GA", "G", "T", "G", "T", "T", "A", "A", "T", "G", "T", "A", "T", "G", "T", "T", "T", "A", "T", "C", "A", "G", "A", "T", "C", "GGCAT", "A", "C", "A", "T", "A", "T", "A", "A", "T", "A", "A", "C", "C", "A", "A", "T", "T", "T", "G", "G", "C", "T", "G", "A", "A", "T", "A", "A", "C", "C", "C", "T", "T", "A", "T", "T", "A", "A", "A", "T", "A", "T", "A", "C", "T", "G", "A", "A", "T", "A", "A", "C", "T", "T", "G", "G", "G", "G", "C", "T", "A", "A", "C", "C", "TC", "A", "A", "T", "A", "G", "A", "A", "A", "T", "A", "C", "T", "A", "G", "G", "T", "C", "G", "A", "A", "ATGGAG", "ATGGAG", "TTGGAG", "A", "GGTGGA", "G", "G", "G", "G", "G", "A", "A", "A", "T", "G", "C", "C", "T", "T", "A", "T", "G", "A", "T", "G", "G", "G", "T", "C", "A", "A", "A", "C", "A", "C", "C", "A", "G", "T", "AC", "T", "A", "T", "C", "C", "T", "G", "C", "T", "G", "A", "T", "T", "T", "T", "T", "G", "T", "T", "T", "G", "A", "T", "A", "A", "A", "T", "C", "C", "C", "C", "C", "G", "G", "C", "A", "A", "G", "A", "A", "G", "A", "G", "A", "C", "G", "A", "A", "G", "G", "A", "G", "A", "G", "T", "G", "G", "A", "G", "G", "G", "A", "GA", "T", "G", "G", "A", "A", "T", "A", "T", "G", "C", "A", "T", "C", "T", "T", "T", "T", "G", "T", "C", "C", "T", "C", "A", "C", "G", "C", "G", "C", "C", "T", "c")

# test data: VariantKey
v.vk <- c("0fffffff88b80000", "08027a2188c80000", "080000003c6f5d8f", "0fffffff8ae2503b", "08027a2588b00000", "08027a2a13ace339", "08027a2bed669117", "08027a3c08e80000", "08000000adb746f9", "08027a41e6f83195", "08027a4708d80000", "100036b088c00000", "100036b188c80000", "100036b288900000", "100036b688e80000", "100036b8b6c70401", "100036c688900000", "100036cc08900000", "100036cc88e80000", "100036cd328d8b62", "100036d18d436362", "100036e5508d8d8c", "100036f4097c0000", "1800923208c00000", "1800923588c00000", "1800925199160000", "1800925190900000", "1800925210dc0000", "1800925210dc0000", "1800925288e00000", "1800925588c00000", "1800925908b80000", "1800925988980000", "1800926708b80000", "1800926d28b9e800", "1800926d28b9e800", "2000762108e80000", "2000762b09060000", "2000762b10980000", "2000762b189e0000", "2000762b09060000", "2000762b09060000", "2000762b10980000", "2000763088e00000", "2000764c88c00000", "2000766708c00000", "2000768588c00000", "200076c988e80000", "200076d188b80000", "200076e188b80000", "2800374d10980000", "2800375488c80000", "2800375908b80000", "2800375a88b80000", "2800375b08c00000", "2800376a88e80000", "2800376b88a00000", "2800376f88b80000", "2800377a88900000", "2800378288e80000", "280037af08b80000", "280037b308e80000", "280037b808c00000", "280037c408e00000", "280037ce08d80000", "3001796419550000", "3001796488c00000", "3001796508c00000", "3001796b08900000", "3001798890ba0000", "3001798e88900000", "3001798f88c00000", "30017994a8b76800", "30017994a8b76800", "3001799498b68000", "3001799508c00000", "300179989ae9db00", "30017998a269f680", "3001799988900000", "3001799b98d90000", "3001799b98d90000", "381174a408b80000", "381174b208e80000", "381174bf88c00000", "381174c808c00000", "381174d808c00000", "381174e00a87b800", "381174ef88b80000", "381174f008d80000", "3811750788a00000", "3811750808c00000", "3811750f88e00000", "3811751a30cffc00", "3811751a90ba0000", "3811751ab8bffe80", "3811751a98be8000", "3811751ab8bffe80", "3811751a892e0000", "4001475b88c80000", "4001475e88b80000", "4001475f88b80000", "4001476808a00000", "400147aa18be8000", "400147ab08e00000", "400147af88e00000", "400147b208f00000", "400147bc08e80000", "400147c088c00000", "400147c308a00000", "400147c688b80000", "400147c9ca7373c1", "400147cf88880000", "400147cf90980000", "400147d088f00000", "400147df88e80000", "400147e808e80000", "4800a1d788900000", "4800a1da88c00000", "4800a1e690ba0000", "4800a1fe19fda000", "4800a1fe227ced00", "4800a1fe88e80000", "4800a1ff88b00000", "4800a21b08880000", "4800a21f08980000", "4800a22088a00000", "4800a22618df0000", "4800a22688e80000", "4800a22e88900000", "4800a23088980000", "4800a23208c80000", "4800a2328b56fa00", "4800a23309a98000", "4800a2330a2a6000", "4800a23608c80000", "5000c76e88b80000", "5000c77c88a00000", "5000c78288a00000", "5000c79088e80000", "5000c79208b80000", "5000c7b588f00000", "5000c7de88b80000", "5000c7e808c00000", "5000c7f108980000", "5000c80a88b80000", "5000c81508c00000", "5000c81808a00000", "5000c82988b80000", "5000c82a08b80000", "5000c83288c00000", "5000c83808900000", "5000c840e5b54eb7", "5000c84288b80000", "5000c84308c00000", "5000c84608d80000", "580196ec897a0000", "5801970008c80000", "5801970788c80000", "5801970988c80000", "5801971688b00000", "5801971810880000", "5801973290ee0000", "5801973488900000", "5801976008b80000", "5801976d88c00000", "5801976e08c00000", "5801977008c00000", "5801977508c80000", "5801978008c80000", "5801978208b80000", "58019797ac32f6a3", "58019797ac32f6a3", "580197a188e80000", "580197a588c80000", "580197b208b80000", "580197b588b80000", "6000b92908c80000", "6000b98a88c80000", "6000b98d88d80000", "6000b99588e80000", "6000b99688b80000", "6000b99a08c80000", "6000b99b08b80000", "6000b99f88b80000", "6000b9a088b80000", "6000b9ab08c80000", "6000b9af08a00000", "6000b9b188900000", "6000b9b488c80000", "6000b9b788b00000", "6000b9bc08b80000", "6000b9bf88c80000", "6000b9c788900000", "6000b9cc88d80000", "6000b9d088b00000", "6000b9d188c00000", "6000b9d888b00000", "6000b9e508c00000", "68915ea388e80000", "68915eaf08e80000", "68915eb908980000", "68915ed208900000", "68915ee608f00000", "68915ee888900000", "68915ef418860000", "68915ef608e00000", "68915effa0e66000", "68915f0689870000", "68915f06989c0000", "68915f06989c0000", "68915f0788c00000", "68915f0990e60000", "68915f0d99edb97f", "68915f0e08900000", "68915f1230d98400", "68915f1690980000", "68915f2c89fe0000", "68915f3808900000", "68915f4288c00000", "68915f4488c00000", "68915f4608c00000", "70914fd108b80000", "70914fd988f00000", "70914fda08c80000", "70914fdd88a00000", "70914ff408880000", "70914ffc08e80000", "70914ffc88c80000", "70914fff08880000", "7091500a08e80000", "7091500b88c00000", "7091501a88b80000", "7091501b08b80000", "7091502288a00000", "7091502408b80000", "7091502a88900000", "7091502b08f00000", "7091502e08a00000", "709150321b05e6bd", "7091503788c00000", "7091503808900000", "7091503888c80000", "7091503988b00000", "7091503e88980000", "7091504188980000", "7898d21888d80000", "7898d21d08c80000", "7898d21d88e80000", "7898d21e08b00000", "7898d21e88b80000", "7898d22208900000", "7898d22388c00000", "7898d22508b80000", "7898d22788900000", "7898d22888900000", "7898d22d88a00000", "7898d22f88b80000", "7898d23309060000", "7898d23688d80000", "7898d23708880000", "7898d23808b80000", "7898d23c08900000", "7898d24108c00000", "7898d24308880000", "7898d24589780000", "7898d2458af86000", "7898d24710e60000", "7898d25688a00000", "7898d26008b80000", "7898d26308c80000", "7898d26a08880000", "8001023488900000", "8001023d08b80000", "8001023f08880000", "8001023f88e80000", "8001024208c00000", "8001024308c00000", "8001024508b00000", "8001024a88c00000", "8001024e88c00000", "8001024f88b80000", "8001025008c00000", "8001027408b80000", "8001028d08900000", "8001029908d80000", "800102a708e80000", "800102b788b80000", "800102b808c00000", "800102cc08d80000", "800102ce88c00000", "800102d788b80000", "800102db88c00000", "800102e788d80000", "800102f988b80000", "8001030988c00000", "8001031408c00000", "8001031708b80000", "880082a208c00000", "880082a308900000", "880082a388b80000", "880082aa88c00000", "880082b808880000", "880082bc08e00000", "880082bd88c80000", "880082cd08b80000", "880082cd88f00000", "880082d608900000", "880082d990c40000", "880082da88b80000", "880082e108e80000", "880082ea20de4000", "880082ee08c00000", "880082f088b00000", "880082fc88c00000", "880082ff88c00000", "8800831788e80000", "880083215df7000b", "8800832188900000", "8800832208e80000", "8800832b08900000", "8800832e89500000", "8800832e90c40000", "8800833688b80000", "8800833c08b00000", "9000a61608b80000", "9000a61b88b80000", "9000a62608c00000", "9000a63208e00000", "9000a63308b80000", "9000a63c08b00000", "9000a64388d80000", "9000a64788c00000", "9000a64c08b80000", "9000a64c88900000", "9000a64e08b80000", "9000a65208b80000", "9000a65308b80000", "9000a65c188e0000", "9000a66188b80000", "9000a667a0a42000", "9000a66b10880000", "9000a66c08900000", "9000a67688c00000", "9000a67908b80000", "9000a67a08c80000", "9000a67b0ad49800", "9000a67b08c00000", "9000a68008e80000", "9000a68c08a00000", "9000a68e88b80000", "9000a68f08c00000", "9000a6a588b80000", "9802254f88c00000", "9802255308c00000", "9802256808d80000", "9802256908c00000", "9802257208c00000", "9802257408e80000", "9802257608c80000", "9802257c08c00000", "9802257f08a00000", "9802258508b80000", "9802258608b80000", "9802258788b80000", "9802258908b00000", "9802258b88f00000", "9802258d88e80000", "9802258f88b80000", "9802259308b00000", "9802259388c00000", "9802259908c00000", "9802259d08b80000", "9802259d88c00000", "9802259e08c00000", "980225a208e80000", "980225a308c80000", "980225a688e80000", "980225a788d80000", "980225aa88b80000", "980225ac08c00000", "980225ad08b80000", "a0012a8888b80000", "a0012a8f88e00000", "a0012a9288c00000", "a0012a9988c00000", "a0012aa108d80000", "a0012aa588c00000", "a0012aa908b80000", "a0012ab908c00000", "a0012ac588e80000", "a0012acb88b80000", "a0012acf88b00000", "a0012ad208c00000", "a0012ad608c00000", "a0012ad688b80000", "a0012ad708c00000", "a0012adf08c00000", "a0012af008e80000", "a0012b0508b80000", "a0012b1908b80000", "a0012b1988f00000", "a0012b1f08900000", "a0012b2088900000", "a0012b2808900000", "a0012b5908e80000", "a0012b6208b80000", "a0012b6288c00000", "a0012b65a89fa000", "a0012b67b0bfda00", "a0012b6888e80000", "a0012b68897a0000", "a852660a88c00000", "a852660f88c00000", "a852661108980000", "a852661788a00000", "a852661888900000", "a852661988c00000", "a852662408c00000", "a852662888c00000", "a852662b08b80000", "a852663088c00000", "a852663908c80000", "a852663988d80000", "a852663e08c00000", "a852664208b00000", "a852664308900000", "a852664588d80000", "a852664988c80000", "a852664c08b00000", "a852664e88c00000", "a852665008e00000", "a85266548b074400", "a85266548b074400", "a85266550b7f4400", "a852665988c00000", "a852665c0b55d000", "a852665e88900000", "a852666017a5d0fb", "a852666110dc0000", "a852666708900000", "a852667288900000", "a852667608c00000", "b07daa0088a00000", "b07daa1388a00000", "b07daa1508b80000", "b07daa2e08f00000", "b07daa3288c80000", "b07daa3708e80000", "b07daa4088d80000", "b07daa5788980000", "b07daa5c08e00000", "b07daa6288980000", "b07daad208900000", "b07daad790980000", "b07daafb08b80000", "b07daafb88900000", "b07dab3610c40000", "b07dab4888f00000", "b07dab5008b80000", "b07dab8788880000", "b07dabdf88c00000", "b07dac3888a00000", "b07dad5888c00000", "b07dad7808e80000", "b07dadf488c00000", "b07dae8b08c80000", "b07dae8e08c80000", "b07dae9608c00000", "b07daea288900000", "b07daeb108b80000", "b07daeb809020000", "b07daeef88b80000", "b07daf1988c00000", "b07daf1b08980000", "b815477e08e80000", "b815478888e80000", "b815478a88d80000", "b815478d08900000", "b815479188c80000", "b815479588d80000", "b815479f08b00000", "b81547a388c00000", "b81547acc8f5dd98", "b81547b688b80000", "b81547f008b80000", "b81547f808b80000", "b815480088d80000", "b815480408f00000", "b815481788b80000", "b815481990e60000", "b815481990e60000", "b815484d88b00000", "b815485d88a00000", "b815487b08b80000", "b815489508c00000", "b815489a08c00000", "b815489b88c00000", "b81548ae08b80000", "b81548b0a19a0209", "b81548b0b83193ef", "b81548b0a19a0209", "b81548b0b83193ef", "b81548b0a19a0209", "b81548d488b00000", "b81548eb88f00000", "b815492708880000", "b815492b08c00000", "c003669008c00000", "c00366a588900000", "c00366a698840000", "c00366a988c00000", "c00366ad28c41000", "c00366b17f91cdb1", "c00366b288900000", "c00366b832728b71", "c00366bd28a00800", "c00366be88900000", "c00366c408c00000", "c00366cd28804000", "c00366da20d04000", "c00366e130c04400", "c00366e4a8844000", "c00366ef88900000", "c00366f608c00000", "c00366f8a8c41000", "c00366fe08980000", "c003670198c10000", "c003670288900000", "c003670388c00000", "c003670b08900000", "c003670c98c10000", "c003670d08900000", "c003670d6842610d", "c003671689500000", "c003671e88d80000", "c003671f08900000", "c003672108900000", "c003672128814000", "c003672308c00000", "c003673308b80000", "c003673388c00000", "c8001fd888b80000", "c8001fda08900000", "c8001fdb08e80000", "c8001fdf08c00000", "c8001fdf88b80000", "c8001fe208e80000", "c8001fe308b80000", "c8001fe588b80000", "c8001fe808b80000", "c8001feb88b80000", "c8001fec08900000", "c8001ff108b80000", "c8001ff188e80000", "c8001ff308e80000", "c8001ff388b80000", "c8001ff488e80000", "c800200288c00000", "c800200308c80000", "c800200708900000", "c800201e08e80000", "c800203908900000", "c800203f88e80000", "c800204308e80000", "c800204788b80000", "c800204808e80000")

# rest data: expected reversed REF
v.rref <- c("C", "G", "", "", "C","", "", "T", "", "","G", "G", "G", "A", "T", "", "A", "A", "T", "ACGTAC", "G", "ACGTACGTAC", "T", "G", "G", "AGT", "AG", "GT", "GT", "T", "G", "C", "A", "C", "CTATT", "CTATT", "T", "A", "AT", "ATT", "A", "A", "AT", "T", "G", "G", "G", "T", "C", "C", "AT", "G", "C", "C", "G", "T", "C", "C", "A", "T", "C", "T", "G", "T", "G", "GGG", "G", "G", "A", "CT", "A", "G", "CGTGT", "CGTGT", "CGT", "G", "TCA", "TCAT", "A", "GTA", "GTA", "C", "T", "G", "G", "G", "A", "C", "G", "C", "G", "T", "GCTTTT", "CT", "CTTTTTT", "CTT", "CTTTTTT", "C", "G", "C", "C", "C", "CTT", "T", "T", "T", "T", "G", "C", "C", "", "A", "AT", "T", "T", "T", "A", "G", "CT", "TTG", "TTGC", "T", "C", "A", "A", "C", "GTT", "T", "A", "A", "G", "G", "C", "C", "G", "C", "C", "C", "T", "C", "T", "C", "G", "A", "C", "G", "C", "C", "C", "G", "A", "", "C", "G", "G", "T", "G", "G", "G", "C", "AC", "TC", "A", "C", "G", "G", "G", "G", "G", "C", "", "", "T", "G", "C", "C", "G", "G", "G", "T", "C", "G", "C", "C", "C", "G", "C", "A", "G", "C", "C", "G", "A", "G", "C", "G", "C", "G", "T", "T", "A", "A", "T", "A", "AAT", "T", "TATA", "A", "ATG", "ATG", "G", "TA", "", "A", "GTATAA", "AT", "T", "A", "G", "G", "G", "C", "T", "G", "C", "A", "T", "G", "A", "T", "G", "C", "C", "C", "C", "A", "T", "C", "", "G", "A", "G", "C", "A", "A", "G", "G", "T", "C", "C", "A", "G", "C", "A", "A", "C", "C", "A", "G", "A", "C", "A", "G", "A", "T", "T", "TA", "C", "C", "G", "A", "A", "C", "A", "T", "G", "G", "C", "G", "G", "C", "G", "C", "A", "G", "T", "C", "G", "G", "G", "C", "G", "G", "C", "G", "G", "C", "G", "A", "C", "G", "A", "T", "G", "C", "T", "A", "GA", "C", "T", "GTTA", "G", "C", "G", "G", "T", "", "A", "T", "A", "G", "GA", "C", "C", "C", "C", "G", "T", "C", "C", "G", "G", "C", "A", "C", "C", "C", "ACT", "C", "CAGA", "AC", "A", "G", "C", "G", "G", "G", "T", "C", "C", "G", "C", "G", "G", "G", "G", "G", "T", "G", "G", "C", "C", "C", "C", "C", "T", "T", "C", "C", "G", "G", "C", "G", "G", "T", "G", "T", "G", "C", "G", "C", "C", "T", "G", "G", "G", "G", "C", "G", "T", "C", "C", "G", "G", "C", "G", "G", "T", "C", "C", "T", "A", "A", "A", "T", "C", "G", "ATTTC", "CTTTGT", "T", "T", "G", "G", "A", "C", "A", "G", "G", "G", "C", "G", "G", "G", "G", "C", "A", "G", "G", "C", "G", "T", "A", "A", "T", "G", "G", "A", "", "GT", "A", "A", "G", "C", "C", "C", "T", "G", "T", "G", "A", "T", "A", "A", "AT", "C", "A", "GA", "T", "C", "A", "G", "C", "G", "T", "G", "G", "G", "G", "A", "C", "A", "C", "G", "A", "T", "T", "G", "A", "G", "G", "C", "G", "TGGTGTGTA", "C", "C", "C", "G", "T", "C", "TA", "TA", "C", "C", "C", "G", "G", "G", "C", "", "", "", "", "", "C", "T", "A", "G", "G", "A", "AAG", "G", "GAGAA", "", "A", "", "CAAAA", "A", "G", "AAAAG", "GGAA", "GAAAGA", "AAGAG", "A", "G", "GAGAA", "A", "GAA", "A", "G", "A", "GAA", "A", "", "G", "G", "A", "A", "AAAGG", "G", "C", "G", "C", "A", "T", "G", "C", "T", "C", "C", "C", "C", "A", "C", "T", "T", "C", "T", "G", "G", "A", "T", "A", "T", "T", "C", "T")

# rest data: expected reversed ALT
v.ralt <- c("T", "C", "", "", "G", "", "", "C", "", "", "T", "A", "C", "G", "C", "", "G", "G", "C", "CGTAC", "ACGTACGTAC", "G", "TG", "A", "A", "AA", "A", "G", "G", "A", "A", "T", "T", "T", "C", "C", "C", "AT", "A", "A", "AT", "AT", "A", "A", "A", "A", "A", "C", "T", "T", "A", "C", "T", "T", "A", "C", "A", "T", "G", "C", "T", "C", "A", "A", "T", "GA", "A", "A", "G", "C", "G", "A", "C", "C", "C", "A", "TGTCG", "TGTC", "G", "G", "G", "T", "C", "A", "A", "A", "ATTCT", "T", "T", "A", "A", "A", "G", "C", "C", "C", "C", "CT", "C", "T", "T", "A", "C", "A", "A", "G", "C", "A", "A", "T", "", "C", "A", "G", "C", "C", "G", "A", "C", "TCA", "TCGG", "C", "G", "C", "T", "A", "G", "C", "G", "T", "C", "GTCTTC", "CAT", "CCAT", "C", "T", "A", "A", "C", "T", "G", "T", "A", "T", "T", "A", "A", "T", "T", "A", "G", "", "T", "A", "T", "TC", "C", "C", "C", "G", "A", "T", "G", "T", "A", "A", "A", "C", "C", "T", "", "", "C", "C", "T", "T", "C", "C", "T", "C", "T", "C", "T", "T", "T", "C", "A", "G", "C", "G", "T", "C", "G", "T", "G", "A", "G", "A", "C", "C", "T", "G", "G", "G", "A", "A", "T", "ATG", "A", "A", "A", "T", "", "G", "G", "A", "TTA", "G", "A", "A", "A", "T", "G", "C", "A", "C", "C", "C", "C", "C", "A", "T", "T", "A", "T", "G", "G", "A", "", "A", "G", "C", "G", "T", "T", "T", "C", "C", "G", "T", "G", "A", "T", "G", "G", "A", "T", "AT", "T", "C", "T", "G", "A", "C", "TA", "TAATA", "T", "A", "T", "C", "C", "G", "T", "C", "C", "A", "A", "G", "A", "A", "T", "A", "T", "G", "T", "C", "T", "A", "T", "A", "T", "A", "T", "T", "A", "A", "T", "A", "G", "T", "A", "C", "A", "C", "T", "G", "G", "G", "T", "C", "G", "A", "G", "A", "A", "C", "", "G", "C", "G", "GA", "G", "T", "G", "T", "T", "A", "A", "T", "G", "T", "A", "T", "G", "T", "T", "T", "A", "T", "C", "A", "G", "A", "T", "C", "GGCAT", "A", "C", "A", "T", "A", "T", "A", "A", "T", "A", "A", "C", "C", "A", "A", "T", "T", "T", "G", "G", "C", "T", "G", "A", "A", "T", "A", "A", "C", "C", "C", "T", "T", "A", "T", "T", "A", "A", "A", "T", "A", "T", "A", "C", "T", "G", "A", "A", "T", "A", "A", "C", "T", "T", "G", "G", "G", "G", "C", "T", "A", "A", "C", "C", "TC", "A", "A", "T", "A", "G", "A", "A", "A", "T", "A", "C", "T", "A", "G", "G", "T", "C", "G", "A", "A", "ATGGAG", "ATGGAG", "TTGGAG", "A", "GGTGGA", "G", "", "G", "G", "G", "A", "A", "A", "T", "G", "C", "C", "T", "T", "A", "T", "G", "A", "T", "G", "G", "G", "T", "C", "A", "A", "A", "C", "A", "C", "C", "A", "G", "T", "AC", "T", "A", "T", "C", "C", "T", "G", "C", "T", "G", "A", "T", "T", "T", "T", "T", "G", "T", "T", "T", "G", "A", "T", "A", "A", "A", "T", "", "", "", "", "", "G", "G", "C", "A", "A", "G", "A", "A", "G", "", "G", "", "C", "G", "A", "A", "G", "G", "A", "G", "A", "G", "T", "G", "G", "A", "G", "G", "G", "", "GA", "T", "G", "G", "A", "A", "T", "A", "T", "G", "C", "A", "T", "C", "T", "T", "T", "T", "G", "T", "C", "C", "T", "C", "A", "C", "G", "C", "G", "C", "C", "T", "C")

# rest data: expected REF+ALT encoding
v.refalt <- c(0x08b80000, 0x08c80000, 0x3c6f5d8f, 0x0ae2503b, 0x08b00000, 0x13ace339, 0x6d669117, 0x08e80000, 0x2db746f9, 0x66f83195, 0x08d80000, 0x08c00000, 0x08c80000, 0x08900000, 0x08e80000, 0x36c70401, 0x08900000, 0x08900000, 0x08e80000, 0x328d8b62, 0x0d436362, 0x508d8d8c, 0x097c0000, 0x08c00000, 0x08c00000, 0x19160000, 0x10900000, 0x10dc0000, 0x10dc0000, 0x08e00000, 0x08c00000, 0x08b80000, 0x08980000, 0x08b80000, 0x28b9e800, 0x28b9e800, 0x08e80000, 0x09060000, 0x10980000, 0x189e0000, 0x09060000, 0x09060000, 0x10980000, 0x08e00000, 0x08c00000, 0x08c00000, 0x08c00000, 0x08e80000, 0x08b80000, 0x08b80000, 0x10980000, 0x08c80000, 0x08b80000, 0x08b80000, 0x08c00000, 0x08e80000, 0x08a00000, 0x08b80000, 0x08900000, 0x08e80000, 0x08b80000, 0x08e80000, 0x08c00000, 0x08e00000, 0x08d80000, 0x19550000, 0x08c00000, 0x08c00000, 0x08900000, 0x10ba0000, 0x08900000, 0x08c00000, 0x28b76800, 0x28b76800, 0x18b68000, 0x08c00000, 0x1ae9db00, 0x2269f680, 0x08900000, 0x18d90000, 0x18d90000, 0x08b80000, 0x08e80000, 0x08c00000, 0x08c00000, 0x08c00000, 0x0a87b800, 0x08b80000, 0x08d80000, 0x08a00000, 0x08c00000, 0x08e00000, 0x30cffc00, 0x10ba0000, 0x38bffe80, 0x18be8000, 0x38bffe80, 0x092e0000, 0x08c80000, 0x08b80000, 0x08b80000, 0x08a00000, 0x18be8000, 0x08e00000, 0x08e00000, 0x08f00000, 0x08e80000, 0x08c00000, 0x08a00000, 0x08b80000, 0x4a7373c1, 0x08880000, 0x10980000, 0x08f00000, 0x08e80000, 0x08e80000, 0x08900000, 0x08c00000, 0x10ba0000, 0x19fda000, 0x227ced00, 0x08e80000, 0x08b00000, 0x08880000, 0x08980000, 0x08a00000, 0x18df0000, 0x08e80000, 0x08900000, 0x08980000, 0x08c80000, 0x0b56fa00, 0x09a98000, 0x0a2a6000, 0x08c80000, 0x08b80000, 0x08a00000, 0x08a00000, 0x08e80000, 0x08b80000, 0x08f00000, 0x08b80000, 0x08c00000, 0x08980000, 0x08b80000, 0x08c00000, 0x08a00000, 0x08b80000, 0x08b80000, 0x08c00000, 0x08900000, 0x65b54eb7, 0x08b80000, 0x08c00000, 0x08d80000, 0x097a0000, 0x08c80000, 0x08c80000, 0x08c80000, 0x08b00000, 0x10880000, 0x10ee0000, 0x08900000, 0x08b80000, 0x08c00000, 0x08c00000, 0x08c00000, 0x08c80000, 0x08c80000, 0x08b80000, 0x2c32f6a3, 0x2c32f6a3, 0x08e80000, 0x08c80000, 0x08b80000, 0x08b80000, 0x08c80000, 0x08c80000, 0x08d80000, 0x08e80000, 0x08b80000, 0x08c80000, 0x08b80000, 0x08b80000, 0x08b80000, 0x08c80000, 0x08a00000, 0x08900000, 0x08c80000, 0x08b00000, 0x08b80000, 0x08c80000, 0x08900000, 0x08d80000, 0x08b00000, 0x08c00000, 0x08b00000, 0x08c00000, 0x08e80000, 0x08e80000, 0x08980000, 0x08900000, 0x08f00000, 0x08900000, 0x18860000, 0x08e00000, 0x20e66000, 0x09870000, 0x189c0000, 0x189c0000, 0x08c00000, 0x10e60000, 0x19edb97f, 0x08900000, 0x30d98400, 0x10980000, 0x09fe0000, 0x08900000, 0x08c00000, 0x08c00000, 0x08c00000, 0x08b80000, 0x08f00000, 0x08c80000, 0x08a00000, 0x08880000, 0x08e80000, 0x08c80000, 0x08880000, 0x08e80000, 0x08c00000, 0x08b80000, 0x08b80000, 0x08a00000, 0x08b80000, 0x08900000, 0x08f00000, 0x08a00000, 0x1b05e6bd, 0x08c00000, 0x08900000, 0x08c80000, 0x08b00000, 0x08980000, 0x08980000, 0x08d80000, 0x08c80000, 0x08e80000, 0x08b00000, 0x08b80000, 0x08900000, 0x08c00000, 0x08b80000, 0x08900000, 0x08900000, 0x08a00000, 0x08b80000, 0x09060000, 0x08d80000, 0x08880000, 0x08b80000, 0x08900000, 0x08c00000, 0x08880000, 0x09780000, 0x0af86000, 0x10e60000, 0x08a00000, 0x08b80000, 0x08c80000, 0x08880000, 0x08900000, 0x08b80000, 0x08880000, 0x08e80000, 0x08c00000, 0x08c00000, 0x08b00000, 0x08c00000, 0x08c00000, 0x08b80000, 0x08c00000, 0x08b80000, 0x08900000, 0x08d80000, 0x08e80000, 0x08b80000, 0x08c00000, 0x08d80000, 0x08c00000, 0x08b80000, 0x08c00000, 0x08d80000, 0x08b80000, 0x08c00000, 0x08c00000, 0x08b80000, 0x08c00000, 0x08900000, 0x08b80000, 0x08c00000, 0x08880000, 0x08e00000, 0x08c80000, 0x08b80000, 0x08f00000, 0x08900000, 0x10c40000, 0x08b80000, 0x08e80000, 0x20de4000, 0x08c00000, 0x08b00000, 0x08c00000, 0x08c00000, 0x08e80000, 0x5df7000b, 0x08900000, 0x08e80000, 0x08900000, 0x09500000, 0x10c40000, 0x08b80000, 0x08b00000, 0x08b80000, 0x08b80000, 0x08c00000, 0x08e00000, 0x08b80000, 0x08b00000, 0x08d80000, 0x08c00000, 0x08b80000, 0x08900000, 0x08b80000, 0x08b80000, 0x08b80000, 0x188e0000, 0x08b80000, 0x20a42000, 0x10880000, 0x08900000, 0x08c00000, 0x08b80000, 0x08c80000, 0x0ad49800, 0x08c00000, 0x08e80000, 0x08a00000, 0x08b80000, 0x08c00000, 0x08b80000, 0x08c00000, 0x08c00000, 0x08d80000, 0x08c00000, 0x08c00000, 0x08e80000, 0x08c80000, 0x08c00000, 0x08a00000, 0x08b80000, 0x08b80000, 0x08b80000, 0x08b00000, 0x08f00000, 0x08e80000, 0x08b80000, 0x08b00000, 0x08c00000, 0x08c00000, 0x08b80000, 0x08c00000, 0x08c00000, 0x08e80000, 0x08c80000, 0x08e80000, 0x08d80000, 0x08b80000, 0x08c00000, 0x08b80000, 0x08b80000, 0x08e00000, 0x08c00000, 0x08c00000, 0x08d80000, 0x08c00000, 0x08b80000, 0x08c00000, 0x08e80000, 0x08b80000, 0x08b00000, 0x08c00000, 0x08c00000, 0x08b80000, 0x08c00000, 0x08c00000, 0x08e80000, 0x08b80000, 0x08b80000, 0x08f00000, 0x08900000, 0x08900000, 0x08900000, 0x08e80000, 0x08b80000, 0x08c00000, 0x289fa000, 0x30bfda00, 0x08e80000, 0x097a0000, 0x08c00000, 0x08c00000, 0x08980000, 0x08a00000, 0x08900000, 0x08c00000, 0x08c00000, 0x08c00000, 0x08b80000, 0x08c00000, 0x08c80000, 0x08d80000, 0x08c00000, 0x08b00000, 0x08900000, 0x08d80000, 0x08c80000, 0x08b00000, 0x08c00000, 0x08e00000, 0x0b074400, 0x0b074400, 0x0b7f4400, 0x08c00000, 0x0b55d000, 0x08900000, 0x17a5d0fb, 0x10dc0000, 0x08900000, 0x08900000, 0x08c00000, 0x08a00000, 0x08a00000, 0x08b80000, 0x08f00000, 0x08c80000, 0x08e80000, 0x08d80000, 0x08980000, 0x08e00000, 0x08980000, 0x08900000, 0x10980000, 0x08b80000, 0x08900000, 0x10c40000, 0x08f00000, 0x08b80000, 0x08880000, 0x08c00000, 0x08a00000, 0x08c00000, 0x08e80000, 0x08c00000, 0x08c80000, 0x08c80000, 0x08c00000, 0x08900000, 0x08b80000, 0x09020000, 0x08b80000, 0x08c00000, 0x08980000, 0x08e80000, 0x08e80000, 0x08d80000, 0x08900000, 0x08c80000, 0x08d80000, 0x08b00000, 0x08c00000, 0x48f5dd98, 0x08b80000, 0x08b80000, 0x08b80000, 0x08d80000, 0x08f00000, 0x08b80000, 0x10e60000, 0x10e60000, 0x08b00000, 0x08a00000, 0x08b80000, 0x08c00000, 0x08c00000, 0x08c00000, 0x08b80000, 0x219a0209, 0x383193ef, 0x219a0209, 0x383193ef, 0x219a0209, 0x08b00000, 0x08f00000, 0x08880000, 0x08c00000, 0x08c00000, 0x08900000, 0x18840000, 0x08c00000, 0x28c41000, 0x7f91cdb1, 0x08900000, 0x32728b71, 0x28a00800, 0x08900000, 0x08c00000, 0x28804000, 0x20d04000, 0x30c04400, 0x28844000, 0x08900000, 0x08c00000, 0x28c41000, 0x08980000, 0x18c10000, 0x08900000, 0x08c00000, 0x08900000, 0x18c10000, 0x08900000, 0x6842610d, 0x09500000, 0x08d80000, 0x08900000, 0x08900000, 0x28814000, 0x08c00000, 0x08b80000, 0x08c00000, 0x08b80000, 0x08900000, 0x08e80000, 0x08c00000, 0x08b80000, 0x08e80000, 0x08b80000, 0x08b80000, 0x08b80000, 0x08b80000, 0x08900000, 0x08b80000, 0x08e80000, 0x08e80000, 0x08b80000, 0x08e80000, 0x08c00000, 0x08c80000, 0x08900000, 0x08e80000, 0x08900000, 0x08e80000, 0x08e80000, 0x08b80000, 0x08e80000)

test_that("EncodeChrom", {
    res <- mapply(EncodeChrom, v.chrom, SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(res, equals(v.kchrom))
})

test_that("DecodeChrom", {
    res <- mapply(DecodeChrom, v.kchrom, SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(res, equals(v.nchrom))
})

test_that("EncodeRefAlt", {
    res <- mapply(EncodeRefAlt, v.ref, v.alt, SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(res, equals(v.refalt))
})

test_that("DecodeRefAlt", {
    res <- mapply(DecodeRefAlt, v.refalt, SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(unlist(res[1,]), equals(v.rref))
    expect_that(unlist(res[2,]), equals(v.ralt))
})

test_that("EncodeVariantKey", {
    res <- mapply(EncodeVariantKey, v.kchrom, v.pos, v.refalt, SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_identical(res, v.vk)
})

test_that("ExtractVariantkeyChrom", {
    res <- mapply(ExtractVariantkeyChrom, v.vk, SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(res, equals(v.kchrom))
})

test_that("ExtractVariantkeyPos", {
    res <- mapply(ExtractVariantkeyPos, v.vk, SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(res, equals(v.pos))
})

test_that("ExtractVariantkeyRefAlt", {
    res <- mapply(ExtractVariantkeyRefAlt, v.vk, SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(res, equals(v.refalt))
})

test_that("DecodeVariantkey", {
    res <- mapply(DecodeVariantkey, v.vk, SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(unlist(res[1,]), equals(v.kchrom))
    expect_that(unlist(res[2,]), equals(v.pos))
    expect_that(unlist(res[3,]), equals(v.refalt))
})

test_that("VariantKey", {
    res <- mapply(VariantKey, v.chrom, v.pos, v.ref, v.alt, SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_identical(res, v.vk)
})

test_that("VariantKeyRange", {
    res <- VariantKeyRange(1, 0, 268435455)
    expect_that(res$MIN, equals("0800000000000000"))
    expect_that(res$MAX, equals("0fffffffffffffff"))
})

test_that("CompareVariantkeyChrom", {
    res <- mapply(CompareVariantkeyChrom, "08027a3c08e80000", "100036cc08900000", SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(res, equals(-1))
    res <- mapply(CompareVariantkeyChrom, "0fffffff88b80000", "08027a2188c80000", SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(res, equals(0))
    res <- mapply(CompareVariantkeyChrom, "100036cc08900000", "08027a3c08e80000", SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(res, equals(1))
})

test_that("CompareVariantkeyChromPos", {
    res <- mapply(CompareVariantkeyChromPos, "08027a3c08e80000", "100036cc08900000", SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(res, equals(-1))
    res <- mapply(CompareVariantkeyChromPos, "100036cc08900000", "08027a3c08e80000", SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(res, equals(1))
    res <- mapply(CompareVariantkeyChromPos, "08027a2588b00000", "0fffffff88b80000", SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(res, equals(-1))
    res <- mapply(CompareVariantkeyChromPos, "0fffffff88b80000", "0fffffff8ae2503b", SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(res, equals(0))
    res <- mapply(CompareVariantkeyChromPos, "0fffffff88b80000", "08027a2588b00000", SIMPLIFY = TRUE, USE.NAMES = FALSE)
    expect_that(res, equals(1))
})
